# This file is part of tad-dftd4.
#
# SPDX-Identifier: Apache-2.0
# Copyright (C) 2024 Grimme Group
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
"""
Data for testing D4 coordination number (taken from D4 testsuite).
"""
from __future__ import annotations

import torch
from tad_mctc.data.molecules import merge_nested_dicts, mols
from tad_mctc.typing import Molecule, Tensor, TypedDict


class Refs(TypedDict):
    """Format of reference values."""

    grad: Tensor
    """Nuclear gradient (reference with TPSS0 parameters)."""


class Record(Molecule, Refs):
    """Store for molecular information and reference values."""


refs: dict[str, Refs] = {
    "LiH": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +0.0000000000000000e00,
                        +0.0000000000000000e00,
                        -6.8677584018156501e-05,
                    ],
                    [
                        +0.0000000000000000e00,
                        +0.0000000000000000e00,
                        +6.8677584018156501e-05,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "SiH4": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +2.2773829287714672e-20,
                        +2.2965949864017546e-20,
                        +6.2352981911342518e-20,
                    ],
                    [
                        -3.5863777807514914e-06,
                        -3.5863777807514918e-06,
                        +3.5863777807514859e-06,
                    ],
                    [
                        +3.5863777807514728e-06,
                        +3.5863777807514728e-06,
                        +3.5863777807514685e-06,
                    ],
                    [
                        -3.5863777807514994e-06,
                        +3.5863777807514986e-06,
                        -3.5863777807515037e-06,
                    ],
                    [
                        +3.5863777807514965e-06,
                        -3.5863777807514982e-06,
                        -3.5863777807515037e-06,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "PbH4-BiH3": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        +1.4428023458944837e-10,
                        -4.1110700521299867e-04,
                        -5.3709394032261727e-20,
                    ],
                    [
                        +7.2527806574424741e-05,
                        -4.0371271002344470e-05,
                        +4.4866599542303000e-21,
                    ],
                    [
                        -3.6263973835096664e-05,
                        -4.0371319238885358e-05,
                        -6.2810986942030817e-05,
                    ],
                    [
                        -3.6263973835096677e-05,
                        -4.0371319238885364e-05,
                        +6.2810986942030857e-05,
                    ],
                    [
                        -5.8284295123939918e-12,
                        -8.0695007751431427e-05,
                        +9.8881170424588928e-21,
                    ],
                    [
                        +5.8496431982842310e-11,
                        +5.3986860487943418e-04,
                        -1.1035975639817685e-19,
                    ],
                    [
                        +1.8693053257553101e-05,
                        +2.4349088351898910e-05,
                        -3.2377345073120332e-05,
                    ],
                    [
                        -3.7386162367574712e-05,
                        +2.4349140861313546e-05,
                        +6.4387738881127674e-21,
                    ],
                    [
                        +1.8693053257553155e-05,
                        +2.4349088351899012e-05,
                        +3.2377345073120426e-05,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "MB16_43_01": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        -1.1014110168883644e-04,
                        +2.9800548570215520e-04,
                        -1.8895729404102611e-04,
                    ],
                    [
                        +9.8513040501931219e-05,
                        +1.2858958285013333e-05,
                        -1.1934863630379029e-04,
                    ],
                    [
                        -1.8394076604656681e-04,
                        +4.1392002708634052e-04,
                        +4.4392550791282183e-05,
                    ],
                    [
                        +2.1399265698956393e-05,
                        +6.6132035321854528e-05,
                        -1.4967594674959611e-04,
                    ],
                    [
                        -1.9495160128013233e-04,
                        +1.0533943798545096e-04,
                        +2.3649298153364520e-04,
                    ],
                    [
                        -1.4099789577871555e-04,
                        -1.3981588213150226e-04,
                        +2.0732362034786641e-05,
                    ],
                    [
                        +1.3740152949554417e-04,
                        -1.8536279956065193e-05,
                        -8.5537443988347800e-05,
                    ],
                    [
                        +5.3843095700561549e-04,
                        -2.0430153591258847e-04,
                        +4.8212465089508691e-04,
                    ],
                    [
                        -4.0455229890305809e-04,
                        +8.2663224915918129e-05,
                        +3.3489489357133896e-04,
                    ],
                    [
                        +1.6496142829728347e-04,
                        -7.4003402873887212e-07,
                        +5.3815251111271763e-05,
                    ],
                    [
                        -5.6392234601826652e-05,
                        -5.5546372641686998e-05,
                        +1.6895002413083615e-04,
                    ],
                    [
                        +1.8671923962782619e-04,
                        -5.2658999571030885e-04,
                        -7.1018982616923661e-04,
                    ],
                    [
                        +2.3632210884275888e-04,
                        +1.5195339541837879e-04,
                        -4.6421787089077318e-04,
                    ],
                    [
                        -2.7580886793769307e-04,
                        +2.9895107509496789e-04,
                        +1.8302983692191691e-04,
                    ],
                    [
                        -3.0648025726355825e-04,
                        -2.3869270887734052e-04,
                        +3.2147223745666962e-04,
                    ],
                    [
                        +2.8951745403047238e-04,
                        -2.4560083055184882e-04,
                        -1.2797777030406482e-04,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "MB16_43_02": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        -9.2254693357330238e-05,
                        -1.5985387750588607e-04,
                        +8.6286467850990771e-05,
                    ],
                    [
                        -7.6192321959779824e-04,
                        -1.0185016372159816e-04,
                        +6.1312163225761074e-04,
                    ],
                    [
                        -6.5189980303360991e-05,
                        +2.2994457268625228e-04,
                        +4.9293792130816944e-04,
                    ],
                    [
                        -1.5065558207097226e-04,
                        -2.5383873299550700e-04,
                        -9.3940241272931707e-04,
                    ],
                    [
                        +5.0755569581811489e-05,
                        +2.6884160938223946e-04,
                        +1.5607700110475557e-04,
                    ],
                    [
                        -1.0155364070354833e-04,
                        -5.3314323500504059e-05,
                        -1.9353162464494134e-04,
                    ],
                    [
                        -7.9964891242682677e-05,
                        -1.0086057974759504e-04,
                        -2.7388963788220817e-05,
                    ],
                    [
                        -1.1131987031789032e-05,
                        +1.4830989583481796e-05,
                        +4.8622996677463627e-05,
                    ],
                    [
                        +2.3742656539430944e-04,
                        -2.0888467881933646e-04,
                        +3.4319319896418014e-04,
                    ],
                    [
                        -7.0125188050733185e-05,
                        +1.1091359848535136e-05,
                        -2.1185854725969090e-04,
                    ],
                    [
                        +3.5387042956837783e-04,
                        -4.9378793868695703e-04,
                        +1.4912269289118511e-04,
                    ],
                    [
                        -1.4552254766546035e-04,
                        +1.1794563336286940e-04,
                        -7.3364270580852806e-05,
                    ],
                    [
                        -2.7542381677071829e-04,
                        +6.0201910361337425e-04,
                        -2.7516698243742468e-04,
                    ],
                    [
                        +1.7750879644133646e-04,
                        -7.7649632797703588e-05,
                        +8.2490781044412324e-05,
                    ],
                    [
                        -3.9293534116714094e-04,
                        -1.4387225548192855e-04,
                        +1.5661790112687219e-04,
                    ],
                    [
                        +1.3271195269756988e-03,
                        +3.4923891478026291e-04,
                        -4.0775779178519190e-04,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "vancoh2": Refs(
        {
            "grad": torch.tensor(
                [
                    [
                        -2.2827664029773451e-04,
                        -3.8307222944109948e-05,
                        -1.4919295373295039e-04,
                    ],
                    [
                        -4.2971772240903952e-04,
                        -5.6133267672738875e-04,
                        -4.4152109609032738e-04,
                    ],
                    [
                        -1.7170937540859625e-04,
                        -7.2308912247184560e-04,
                        -7.9716051638614336e-04,
                    ],
                    [
                        -4.6405704684024070e-04,
                        -6.6711904288046999e-04,
                        -5.4675509716766346e-04,
                    ],
                    [
                        -5.9951412125557003e-04,
                        -8.8872159100564208e-04,
                        -1.3574346034782433e-04,
                    ],
                    [
                        -6.0132030929995069e-04,
                        -9.2785482579783591e-04,
                        +4.9561081127565917e-05,
                    ],
                    [
                        -4.9926621920782881e-04,
                        -5.4321110261707623e-04,
                        -1.6066860232949394e-04,
                    ],
                    [
                        -4.2143522614695409e-04,
                        -2.5970437200213827e-04,
                        +7.2154850555962156e-05,
                    ],
                    [
                        -2.9018610148986388e-04,
                        -2.1841500656888797e-04,
                        +3.6375249916962866e-04,
                    ],
                    [
                        +3.4830976904183094e-05,
                        -2.6877056131763386e-04,
                        +2.9040628133197058e-04,
                    ],
                    [
                        -9.6935471420268578e-05,
                        +4.2294634711554323e-05,
                        +3.6694346398533990e-04,
                    ],
                    [
                        -2.0261056639266851e-04,
                        -2.0157787147307227e-04,
                        +3.9123819894566980e-04,
                    ],
                    [
                        -1.0799594579322241e-04,
                        -4.8738771761028733e-06,
                        +6.6551883845494928e-04,
                    ],
                    [
                        -3.2541054768469479e-04,
                        -1.6000964340427193e-05,
                        +5.4680993499421344e-04,
                    ],
                    [
                        -2.9854744699162619e-04,
                        -2.6100568604406056e-05,
                        +3.5936413620041557e-04,
                    ],
                    [
                        -3.1420275474114856e-04,
                        -3.3581157186304269e-04,
                        +1.8126121909388461e-04,
                    ],
                    [
                        -2.0295681908585658e-04,
                        -2.0777652300121909e-04,
                        +1.2062099607534550e-04,
                    ],
                    [
                        +2.5358880092139280e-04,
                        -5.6920678313568005e-04,
                        -3.1676047998069643e-05,
                    ],
                    [
                        +1.4638229375024496e-04,
                        -1.9455014561682552e-04,
                        -2.7066240637995829e-05,
                    ],
                    [
                        +2.1432268954869196e-04,
                        -3.6716763275424055e-04,
                        -2.5374656765918518e-04,
                    ],
                    [
                        +5.1724004723615019e-04,
                        -3.9120278940830695e-04,
                        -2.5982885350707175e-04,
                    ],
                    [
                        +2.7692186467609631e-04,
                        -4.7447147590161159e-04,
                        -4.5084494459306788e-04,
                    ],
                    [
                        +2.7451513716667203e-05,
                        -1.7684124605996923e-04,
                        -1.2236009207947877e-04,
                    ],
                    [
                        +1.2064534233004563e-04,
                        -1.1202114014590977e-04,
                        -1.1170022741779269e-04,
                    ],
                    [
                        -1.3076984009813676e-04,
                        -2.0153212414193594e-04,
                        -5.5185148198278551e-04,
                    ],
                    [
                        -1.8036783065678553e-04,
                        -3.3198117182416695e-04,
                        -7.3235452949041869e-04,
                    ],
                    [
                        -1.1995342091659990e-04,
                        +9.1018337876048485e-05,
                        -1.9638898298579010e-04,
                    ],
                    [
                        +1.2063374520135641e-04,
                        +4.2178941280993533e-05,
                        -1.9828350325807971e-04,
                    ],
                    [
                        -6.5421232728291273e-04,
                        -3.1509841357279931e-04,
                        -5.9921956941668764e-04,
                    ],
                    [
                        -1.8089321497994631e-04,
                        -1.7411956231229886e-04,
                        -2.4314947926253150e-04,
                    ],
                    [
                        -1.5886919862837418e-04,
                        -9.1221578389514735e-05,
                        -1.2334158345997831e-04,
                    ],
                    [
                        -1.5834439847179518e-04,
                        -1.2236272581406279e-04,
                        -2.0320681953533631e-04,
                    ],
                    [
                        -5.8389588469016252e-05,
                        +2.6532545341216310e-05,
                        -4.8172449254587480e-04,
                    ],
                    [
                        +4.7826550078965863e-05,
                        +2.6162468408573459e-05,
                        -6.4130773555260789e-04,
                    ],
                    [
                        +2.5969385050185277e-05,
                        +7.8037499104915097e-05,
                        -1.3583223637530524e-04,
                    ],
                    [
                        +1.7719139003514185e-05,
                        +3.5937043817124969e-05,
                        -2.3799674346965729e-04,
                    ],
                    [
                        +3.4980591339810267e-04,
                        -1.9550585179710673e-06,
                        -4.6512792610294143e-04,
                    ],
                    [
                        +3.2051559197271700e-04,
                        -1.4717446990851859e-04,
                        -3.3150481860002386e-04,
                    ],
                    [
                        +9.1337137233245028e-06,
                        -1.6029987085259620e-04,
                        -4.7056015293566447e-05,
                    ],
                    [
                        +1.4743117902028051e-04,
                        -7.4363611887449840e-05,
                        -1.7081776897432305e-04,
                    ],
                    [
                        +5.5577261125801198e-05,
                        -8.2215238476261563e-05,
                        -1.7654405065420080e-04,
                    ],
                    [
                        +2.2612485772259192e-04,
                        -2.6986857617396494e-05,
                        -2.1006045646187796e-04,
                    ],
                    [
                        +5.9389023472920376e-04,
                        -1.2745212792016937e-04,
                        -7.1096347239966136e-05,
                    ],
                    [
                        +1.6777063108568035e-04,
                        -7.1501116834761191e-05,
                        -7.4322422154974129e-05,
                    ],
                    [
                        +4.5037844580630309e-04,
                        -6.2289442404531051e-04,
                        +1.2786403637435171e-04,
                    ],
                    [
                        +1.5455058075527979e-04,
                        -1.3901748812682971e-04,
                        +7.1191004258203900e-05,
                    ],
                    [
                        +7.5703150383654358e-04,
                        -4.4870092735920962e-04,
                        +4.8258055656039085e-04,
                    ],
                    [
                        +1.3211086475339214e-04,
                        -1.4510270577926856e-04,
                        +1.3958143828187998e-04,
                    ],
                    [
                        +1.0953800790176013e-04,
                        -6.2826770970060661e-04,
                        +6.8815536361985680e-05,
                    ],
                    [
                        +2.8137794253826884e-05,
                        -8.0500907422450748e-04,
                        -2.5232841208410150e-04,
                    ],
                    [
                        -8.8784106206787745e-06,
                        -2.4200415389070713e-04,
                        +1.3763143273749518e-05,
                    ],
                    [
                        +6.7737392104418384e-05,
                        -1.7410288405792271e-04,
                        +8.8773351428928163e-06,
                    ],
                    [
                        -3.0891851854119982e-04,
                        -4.9804467702417869e-04,
                        +1.9616506250794185e-04,
                    ],
                    [
                        -3.2766613362360546e-04,
                        -4.0170777525368585e-04,
                        +5.7056033388942524e-04,
                    ],
                    [
                        -4.7040055113870287e-04,
                        -1.6728824757956373e-04,
                        +4.9648926212619913e-04,
                    ],
                    [
                        -1.0459208933416087e-04,
                        -1.5539350972583260e-04,
                        +1.6264293448212623e-04,
                    ],
                    [
                        -8.9564484307453541e-05,
                        -8.1797620520985970e-05,
                        +1.5792091888341565e-04,
                    ],
                    [
                        -1.2015880304530176e-04,
                        -1.1827832191733052e-04,
                        +2.2893262142660223e-04,
                    ],
                    [
                        -6.2953466828539811e-04,
                        -4.1043948208716844e-04,
                        -5.6416164721865688e-05,
                    ],
                    [
                        -1.1730926333003120e-04,
                        -1.2424574098741031e-04,
                        +7.9063676434682388e-06,
                    ],
                    [
                        +1.9525802789769128e-04,
                        -7.4525463984960393e-05,
                        +5.7237848940792848e-04,
                    ],
                    [
                        +3.7209554585172609e-04,
                        -2.6850525739373192e-04,
                        +5.4944656762880213e-04,
                    ],
                    [
                        +6.2551943671303254e-05,
                        -3.3309871202496984e-04,
                        +8.1132369255974216e-04,
                    ],
                    [
                        +1.0817032819399149e-04,
                        -2.9008013785564635e-04,
                        +8.9861351237436021e-04,
                    ],
                    [
                        +3.6796528607039284e-04,
                        -4.0243013689558298e-04,
                        +5.8370654271155877e-04,
                    ],
                    [
                        +4.9891938018948288e-04,
                        -7.8986233773510291e-04,
                        +1.3683097875130258e-04,
                    ],
                    [
                        +5.9340527102665519e-04,
                        -6.0001561519982193e-04,
                        +1.6390074327636079e-04,
                    ],
                    [
                        +2.6112021414249323e-04,
                        -1.0735471800377228e-04,
                        +2.4524346727920468e-05,
                    ],
                    [
                        +1.4731061546078211e-04,
                        -1.9359980309760873e-04,
                        -3.9915058153624921e-05,
                    ],
                    [
                        +5.0216080500412475e-04,
                        -1.5211760331209874e-07,
                        +5.0641235660404049e-04,
                    ],
                    [
                        +7.0838625642922831e-04,
                        -1.2411482196983750e-04,
                        +3.3627013621227161e-04,
                    ],
                    [
                        +1.3882132884618392e-04,
                        -2.2558350824751299e-05,
                        +8.1314504321672803e-05,
                    ],
                    [
                        +1.4533082288048328e-04,
                        +7.2034252655022871e-06,
                        +1.6546259690118173e-04,
                    ],
                    [
                        +6.5981310141751022e-04,
                        +1.8562272031959093e-04,
                        +5.1299836035434388e-04,
                    ],
                    [
                        +2.8385840259537908e-04,
                        +7.2093128737290679e-04,
                        +6.6464135749058910e-04,
                    ],
                    [
                        -2.8553927023336234e-05,
                        +7.1664907350955183e-04,
                        +7.2871574428403588e-04,
                    ],
                    [
                        +2.3711262428278878e-04,
                        +7.6403729952108964e-04,
                        +7.2549855491684792e-04,
                    ],
                    [
                        -9.2713110411837338e-05,
                        +7.1043821697353818e-04,
                        +6.1939716254607550e-04,
                    ],
                    [
                        -1.6016272712328261e-04,
                        +8.1021964756678995e-04,
                        +3.0623950815427466e-04,
                    ],
                    [
                        -1.0037287659974362e-04,
                        +3.3664601150058262e-04,
                        -8.3786925440674424e-05,
                    ],
                    [
                        -1.3329245175461909e-04,
                        +2.8879452014806501e-04,
                        -5.9044635297252632e-04,
                    ],
                    [
                        -2.1181343037504429e-04,
                        +6.8544517013495465e-04,
                        -6.6334144833839019e-04,
                    ],
                    [
                        -6.1754119091693692e-05,
                        +9.8328236198726962e-04,
                        -4.0455103617418844e-04,
                    ],
                    [
                        +3.7920306882169548e-05,
                        +1.1540375332514132e-03,
                        -6.0831273318638204e-05,
                    ],
                    [
                        +3.2103612925320254e-05,
                        +3.1461529674995525e-04,
                        +4.0327734446308290e-05,
                    ],
                    [
                        +2.1631590170176059e-05,
                        +2.2510048351199089e-04,
                        -1.2043513798630552e-04,
                    ],
                    [
                        -1.8353353758974162e-04,
                        +5.1364387086090643e-04,
                        -8.7708847294984394e-04,
                    ],
                    [
                        -5.8636223972218111e-05,
                        +1.4091908890850503e-04,
                        -2.1067590451210398e-04,
                    ],
                    [
                        +1.8466016237940285e-04,
                        -2.5051274766553315e-04,
                        -6.9719471830991550e-04,
                    ],
                    [
                        +7.1187409674914020e-04,
                        -1.9263985118953887e-04,
                        -3.6239406066906356e-04,
                    ],
                    [
                        +6.8974805094989774e-04,
                        -5.0184036031967235e-04,
                        -4.7241148533840065e-04,
                    ],
                    [
                        +4.9915467764575009e-04,
                        -4.1503269726693778e-04,
                        -3.9994352172518691e-04,
                    ],
                    [
                        +4.1267070871397750e-04,
                        -3.0339065495027398e-04,
                        -5.9829997282997982e-04,
                    ],
                    [
                        +2.0455343845149297e-04,
                        -2.5630294211956219e-04,
                        -7.2560866067081762e-04,
                    ],
                    [
                        -1.0660770561880193e-04,
                        -1.2134601456129926e-04,
                        -7.7095681212950443e-04,
                    ],
                    [
                        -4.7745836044004261e-05,
                        +3.3586897954854665e-05,
                        -2.1071107208727453e-04,
                    ],
                    [
                        +8.9678139448684375e-05,
                        -5.2121165462189419e-05,
                        -1.5907843600358940e-04,
                    ],
                    [
                        +4.0898817562524508e-04,
                        -3.8018210126635599e-04,
                        -2.3312196023113542e-04,
                    ],
                    [
                        +4.6862693254591082e-05,
                        -6.6902043356034140e-05,
                        -3.9009932649790871e-05,
                    ],
                    [
                        +2.2186986116919848e-04,
                        -1.0792868422779178e-04,
                        -7.1677954446422665e-05,
                    ],
                    [
                        +8.8614823279601935e-04,
                        +2.7788225521054461e-04,
                        -2.2248427101083525e-04,
                    ],
                    [
                        +1.0017762522096401e-03,
                        +6.1077734862359845e-05,
                        +1.0711350805852822e-04,
                    ],
                    [
                        +9.0556410064263288e-04,
                        -3.0496195946691521e-05,
                        +4.2094019049146420e-04,
                    ],
                    [
                        +8.1666937856966369e-04,
                        -2.8289666239470211e-04,
                        -3.1659784592668477e-06,
                    ],
                    [
                        +1.0152582600141901e-04,
                        +3.6192231602910093e-04,
                        +1.8406203463541449e-04,
                    ],
                    [
                        +8.1724600252485022e-04,
                        +7.6775094676455194e-04,
                        -3.0486847318906407e-04,
                    ],
                    [
                        +5.9407874702137960e-04,
                        +7.0716059622126601e-04,
                        -5.1390499143529479e-04,
                    ],
                    [
                        +7.9920137752741399e-04,
                        +9.0819035421612867e-04,
                        -4.7686488624547593e-05,
                    ],
                    [
                        +8.4334465735501078e-05,
                        +2.7004829636120289e-04,
                        -7.8623919055000488e-05,
                    ],
                    [
                        +2.1556510037536004e-04,
                        +6.8467361446710337e-05,
                        -1.0737707155817003e-05,
                    ],
                    [
                        +5.5477851820190289e-05,
                        +2.3411352277231481e-05,
                        +3.2671428941522563e-06,
                    ],
                    [
                        -2.7578622551680221e-04,
                        +4.6956070634015308e-04,
                        +7.1043427684928896e-04,
                    ],
                    [
                        -2.2650158735479083e-04,
                        +3.1276471079631150e-04,
                        +7.2056755609329552e-04,
                    ],
                    [
                        +1.3674976235462537e-04,
                        +4.3216833080790827e-04,
                        +7.2702546760886619e-04,
                    ],
                    [
                        -1.4808935690682179e-04,
                        -1.8459349936670042e-05,
                        +4.0557013974905560e-04,
                    ],
                    [
                        +8.4854012652059451e-05,
                        -1.9455057862076660e-04,
                        -1.5299939598631973e-04,
                    ],
                    [
                        -3.1789341754849722e-04,
                        +8.3164056604093840e-05,
                        -6.4327418866738477e-04,
                    ],
                    [
                        -3.2635320443653604e-04,
                        -2.4799217376533122e-04,
                        -5.7026728159109848e-04,
                    ],
                    [
                        +1.1496213527496193e-04,
                        +2.3398437182362155e-04,
                        -7.0686811010315103e-04,
                    ],
                    [
                        +1.4234444573809981e-04,
                        +4.2416127963539258e-04,
                        -8.1455283462948062e-04,
                    ],
                    [
                        -3.5752400319367863e-04,
                        +3.9260535473328601e-04,
                        -8.6203317981671827e-04,
                    ],
                    [
                        -1.8617813950370062e-04,
                        +3.3678078372813286e-04,
                        -8.4107286956803260e-04,
                    ],
                    [
                        -5.6712542848897946e-04,
                        +2.0586218927912575e-04,
                        -6.8570653023795045e-04,
                    ],
                    [
                        -8.2491779091148430e-04,
                        +2.5958134212880347e-04,
                        -1.4879003989094571e-04,
                    ],
                    [
                        -7.8599757209924556e-04,
                        +3.0618655452507550e-04,
                        +3.9156768169061878e-04,
                    ],
                    [
                        -9.0396835109621189e-04,
                        -3.3996230599752114e-05,
                        +1.0366857030175124e-04,
                    ],
                    [
                        -5.0905086047136423e-04,
                        +2.2765141195916968e-04,
                        +3.7927019175775358e-04,
                    ],
                    [
                        -4.2318733874633881e-04,
                        +5.6312123918948623e-04,
                        +4.8252767312086640e-04,
                    ],
                    [
                        -5.3199261165652969e-04,
                        +7.4888373967041757e-04,
                        +1.9610281680915726e-04,
                    ],
                    [
                        -8.6434538809283465e-05,
                        +1.5504847735608535e-04,
                        +4.3580547343346793e-05,
                    ],
                    [
                        -8.1601686007136046e-05,
                        +1.3010910680786672e-04,
                        +3.8142346068642230e-05,
                    ],
                    [
                        -1.2253430542146198e-04,
                        +2.0248048096653626e-04,
                        +1.0047067174879726e-04,
                    ],
                    [
                        -7.2072897182273392e-06,
                        +2.1499240352820676e-04,
                        +4.0230187955659493e-05,
                    ],
                    [
                        -3.2079762322723972e-04,
                        +3.6009173640316298e-05,
                        +7.8818766216724278e-04,
                    ],
                    [
                        -1.2357567259944503e-04,
                        +1.1283392004966981e-04,
                        +2.8305013331159898e-04,
                    ],
                    [
                        -1.6959873792713273e-04,
                        -3.7317595365191234e-07,
                        +2.7414602488586124e-04,
                    ],
                    [
                        -1.4982387410307008e-04,
                        -1.5183991041850314e-04,
                        +7.0338673353973087e-04,
                    ],
                    [
                        -4.6393387416768543e-06,
                        +1.4914582452761377e-04,
                        +7.1811119321771050e-04,
                    ],
                    [
                        +2.2997449594429547e-05,
                        +5.3102230480557471e-05,
                        +1.7680083799330142e-04,
                    ],
                    [
                        +5.5212339962641132e-06,
                        +3.8925975746069586e-05,
                        +1.4356764784043209e-04,
                    ],
                    [
                        -8.2999218140965997e-07,
                        +6.9637835840367471e-05,
                        +2.1730474754031953e-04,
                    ],
                    [
                        -2.4225427669208031e-04,
                        -2.5284417137701095e-04,
                        +8.7035180793917715e-04,
                    ],
                    [
                        -1.1496644239904432e-04,
                        +4.0162204054104590e-07,
                        +3.1741041487724791e-04,
                    ],
                    [
                        -1.2399106683302621e-05,
                        -6.9533153640229581e-05,
                        +1.3699594328476142e-04,
                    ],
                    [
                        -9.8766653352485621e-05,
                        -5.0365890882075952e-05,
                        +3.1862627824457985e-04,
                    ],
                    [
                        -1.5030873080635930e-05,
                        -6.4265401293628327e-05,
                        +1.5870664610652711e-04,
                    ],
                    [
                        -1.3800496044098472e-04,
                        +3.4546099396473898e-05,
                        +5.7288598118604291e-05,
                    ],
                    [
                        +5.5401828958423321e-05,
                        +2.7166674117424990e-04,
                        +1.0357395183771487e-04,
                    ],
                    [
                        -1.4464934292496471e-04,
                        +1.0594377508678528e-04,
                        -1.6196387351803042e-04,
                    ],
                    [
                        -5.0275944020398316e-04,
                        -6.6757022375883845e-05,
                        -6.2272305304560127e-04,
                    ],
                    [
                        -7.4598923799096002e-04,
                        -1.3467154825925820e-04,
                        -4.5227410465336785e-04,
                    ],
                    [
                        -1.5061572991107431e-04,
                        -1.5962382595683122e-05,
                        -9.5812322204390647e-05,
                    ],
                    [
                        -1.7045364986374939e-04,
                        -3.4844997110220495e-05,
                        -1.8205068320166533e-04,
                    ],
                    [
                        +8.7150721824356222e-06,
                        -1.7016784752186835e-05,
                        -9.8319061105816619e-05,
                    ],
                    [
                        -1.6067982028774157e-04,
                        +5.8030173488116707e-04,
                        -4.8485720142315777e-04,
                    ],
                    [
                        -2.3741141601274612e-05,
                        +9.5338381303258280e-04,
                        -1.1433812527775199e-04,
                    ],
                    [
                        +1.2592684018509671e-04,
                        +8.4327034958394038e-04,
                        +1.7833279043338008e-04,
                    ],
                    [
                        +9.2029643389135350e-06,
                        +7.9927128611888406e-04,
                        +1.0483485427270014e-04,
                    ],
                    [
                        -6.9564462581993530e-05,
                        +2.1626543140820489e-04,
                        +1.2077299853955988e-04,
                    ],
                    [
                        +1.9951681314723827e-06,
                        +2.2318216335124301e-04,
                        -1.0204643480176664e-04,
                    ],
                    [
                        -8.5557414865462155e-05,
                        +1.9964226202919767e-04,
                        -1.3970276606885989e-04,
                    ],
                    [
                        -4.7317689719881619e-05,
                        +1.3117013153081771e-04,
                        -1.4765538337648874e-04,
                    ],
                    [
                        +1.5687921680954588e-05,
                        +1.5078936215313877e-05,
                        -1.9410109697326144e-04,
                    ],
                    [
                        -1.3632912306673703e-04,
                        +2.0611857357183346e-04,
                        +1.3898304521787737e-04,
                    ],
                    [
                        -1.9622816265145969e-04,
                        +2.9816361938072084e-05,
                        +1.7163984059643174e-05,
                    ],
                    [
                        -9.1109852237438035e-05,
                        +1.6906354783627429e-04,
                        +3.8843354251055057e-04,
                    ],
                    [
                        -9.3398563255175109e-06,
                        +1.8116726662045275e-04,
                        +1.5939710218960238e-04,
                    ],
                    [
                        -1.1127721757721840e-05,
                        -3.0232463242953375e-06,
                        +2.2358991922090583e-04,
                    ],
                    [
                        +1.0827980616994594e-04,
                        +1.2330080985471488e-04,
                        +1.2554038820038242e-04,
                    ],
                    [
                        -3.0689678650661171e-05,
                        -1.1169548404720035e-05,
                        +2.6077501759638755e-04,
                    ],
                    [
                        -1.7760656178870282e-05,
                        -3.8367092016792319e-05,
                        +2.4630527338772738e-04,
                    ],
                    [
                        -1.0484829401312421e-04,
                        -1.3251131790407191e-04,
                        +1.3059476640113295e-04,
                    ],
                    [
                        +9.9858349360680120e-05,
                        -1.3478278463812825e-04,
                        +4.4511978434401189e-05,
                    ],
                    [
                        -1.6332000769952949e-04,
                        -2.0622376218764089e-04,
                        +6.8809297821916527e-05,
                    ],
                    [
                        -2.2910979466413874e-04,
                        -1.5816158184581012e-04,
                        +2.0940976513279427e-05,
                    ],
                    [
                        -4.9727764628652488e-06,
                        -1.5130951291985511e-04,
                        -2.3740369811967491e-04,
                    ],
                ],
                dtype=torch.double,
            ),
        }
    ),
    "AmF3": Refs(
        {
            "grad": torch.tensor(
                [],
                dtype=torch.double,
            ),
        }
    ),
}


samples: dict[str, Record] = merge_nested_dicts(mols, refs)
